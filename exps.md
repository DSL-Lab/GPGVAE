### Indian Villiage
Best acheived by seperately train for each graph. Reach an average of +0.2 AUC compared to share VAE.
```
export i=0
python main.py --indian_village_i $i --pre_model_type Specformer --game_type village --graph_type indian_village --hidden_dim 256 --n_heads 4 --lr 5e-4 --encoderA transformer --weight_decay 1e-4 --beta2 1 --beta1 8 --encoderZ mlp_on_seq --klA_nsample 50 --nll_nsample 1 --num_mix_component 1 --estimator reinforce --eta 0.99  --n_epochs 200
```
*Result: Graph id, roc_auc, ap*
```
6 0.5068277796259333 0.12040703830841973
4 0.5723950959084474 0.06885064150532094
10 0.5569553102619279 0.048652773489418835
21 0.5739832866452982 0.09075692796858723
28 0.5511571441611413 0.08041577240311612
13 0.5452182059575368 0.07022794570381723
8 0.5361422782421903 0.06775058216100843
23 0.5715136860389919 0.062091172535317804
17 0.5370777249670187 0.05820548830575104
1 0.580149521319973 0.04689256646488784
7 0.5494595143132027 0.054753386876732195
41 0.5881478121214527 0.08711358082979793
25 0.546852144672767 0.050268052132317664
47 0.6469548560164807 0.07720036965240948
0 0.5924692197028163 0.07231644064747916
39 0.5658377791953971 0.05897604202058373
36 0.5658889162491407 0.05532988321830338
9 0.5517084857661143 0.05065030293472067
46 0.5940346186975644 0.0883244417941629
11 0.5550855775665995 0.058223234853415046
5 0.538562291551426 0.05298788883493117
45 0.5817229140423996 0.08407771734760808
26 0.5721931348581681 0.04487828453970062
24 0.5676927918571413 0.047386726344374804
19 0.5734954086429467 0.04702360609517646
12 0.5857495175960954 0.0430036013658586
3 0.5352081343266253 0.0372650271099985
32 0.5318695098650785 0.029197630762167713
14 0.5762753237590217 0.0462236231071191
40 0.558071428430787 0.06485463615287815
22 0.5683568431365651 0.03557186309813295
42 0.555465432362168 0.07243215249533433
27 0.5951437052954549 0.043746220859775836
18 0.5476033649084191 0.044600118217584986
44 0.5632263418782243 0.05790360597318567
2 0.5626910137410575 0.03804566745766245
37 0.6071555056728039 0.04168359658233705
15 0.5650259053083244 0.03502056489764449
29 0.6140296269748241 0.060731604881351306
38 0.5680318309093333 0.04821772187346772
30 0.5826881165464961 0.06959760297457751
20 0.5404713083343553 0.03989219778300698
16 0.5766492191567447 0.03623089955654199
43 0.5477381664238288 0.0399279090781753
35 0.6063156370634362 0.03319534646445434
34 0.5498436339438184 0.030446994492874073
31 0.5751284554315125 0.04943723647509996
```
AUC: Mean 0.5666864578605756 Std 0.0245


### Sapolo 
Best achieved by doing hyper-parameter Grid Search
```
#!/bin/bash
set -x
hidden_dims=(64 96 128 160 192)
beta1s=(6 8 10 12 14)
num_mix_components=(3 4 5 6 7)

for hidden_dim in "${hidden_dims[@]}"; do
    for beta1 in "${beta1s[@]}"; do
        for num_mix in "${num_mix_components[@]}"; do
            for repeat in {1..3}; do
                python main.py --pre_model_type Specformer --game_type Foursquare --graph_type SaoPaulo --hidden_dim $hidden_dim --n_heads 4 --lr 1e-4 --encoderA transformer --weight_decay 0 --beta2 1 --beta1 $beta1 --encoderZ mlp_on_seq --klA_nsample 50 --nll_nsample 10 --num_mix_component $num_mix --estimator reinforce --eta 0.99 --n_epochs 200 > ../exps/sweep/foursquare_sao_paulo_${hidden_dim}_${beta1}_${num_mix}_${repeat}.txt
            done
        done
    done
done
```
Best Result List
```
{'Setting': 'foursquare_sao_paulo_96_8_5', 'ROC_AUC': [0.5776, 0.5657, 0.5647, 0.5705, 0.5635, 0.5706], 'Mean': 0.5687666666666668, 'Std': 0.004797105608825208}
{'Setting': 'foursquare_sao_paulo_96_6_7', 'ROC_AUC': [0.5669, 0.5674, 0.5746, 0.5825, 0.5532, 0.5542], 'Mean': 0.5664666666666668, 'Std': 0.010414359744549292}
{'Setting': 'foursquare_sao_paulo_128_6_6', 'ROC_AUC': [0.568, 0.556, 0.5588, 0.5645, 0.5605, 0.5782], 'Mean': 0.5643333333333334, 'Std': 0.007308822674609705}
{'Setting': 'foursquare_sao_paulo_128_10_6', 'ROC_AUC': [0.5734, 0.5672, 0.5645, 0.5574, 0.5573, 0.5625], 'Mean': 0.5637166666666668, 'Std': 0.005613500591332378}
{'Setting': 'foursquare_sao_paulo_128_6_5', 'ROC_AUC': [0.5635, 0.5734, 0.5698, 0.5554, 0.5492, 0.5668], 'Mean': 0.5630166666666666, 'Std': 0.008339547682911551}
{'Setting': 'foursquare_sao_paulo_96_12_6', 'ROC_AUC': [0.5614, 0.5504, 0.5697, 0.5555, 0.5637, 0.5735], 'Mean': 0.5623666666666667, 'Std': 0.007861226932794198}
{'Setting': 'foursquare_sao_paulo_128_6_4', 'ROC_AUC': [0.5581, 0.5519, 0.5634, 0.5563, 0.5701, 0.5704], 'Mean': 0.5617000000000001, 'Std': 0.006919778416490924}
{'Setting': 'foursquare_sao_paulo_128_12_6', 'ROC_AUC': [0.5593, 0.5675, 0.5593, 0.5427, 0.5613, 0.5745], 'Mean': 0.5607666666666667, 'Std': 0.009703378563961928}
{'Setting': 'foursquare_sao_paulo_128_6_7', 'ROC_AUC': [0.5695, 0.5624, 0.5566, 0.5513, 0.5602, 0.5582], 'Mean': 0.5597, 'Std': 0.005567764362830022}
{'Setting': 'foursquare_sao_paulo_96_6_5', 'ROC_AUC': [0.5519, 0.5598, 0.5629, 0.5643, 0.5537, 0.5654], 'Mean': 0.5596666666666666, 'Std': 0.005175798381785085}
{'Setting': 'foursquare_sao_paulo_160_12_5', 'ROC_AUC': [0.5645, 0.5526, 0.5656, 0.5576, 0.5506, 0.5573], 'Mean': 0.5580333333333333, 'Std': 0.005546370184383863}
{'Setting': 'foursquare_sao_paulo_128_14_5', 'ROC_AUC': [0.5498, 0.5541, 0.551, 0.5562, 0.5573, 0.5601], 'Mean': 0.55475, 'Std': 0.003564056677439363}
```


